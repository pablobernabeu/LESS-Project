# participants need to be separated by language and by grammaticality
library(lme4)
library(stringr)
library(ggplot2)

setwd("C:/Users/chath1626/OneDrive - UiT Office 365/LESS-Project-with-RAs-2/Session 2/Export")

#analysing per Session, for N200, per condition of grammaticality (Segmentation S101 = grammatical, Segmentation S102 = violation of grammaticality) while maintaining the ERP
#creation of regex pattern in order for the programme to look for the pattern of participantNumber_ERP in two different conditions
#creation of regex pattern to create two sets of data

pattern1 = "^[0-9].*N200_S101.txt"
print(pattern1)
pattern2 = "^[0-9].*N200_S102.txt"

file_list1 <- list.files(pattern = pattern1)
print(file_list1)

file_list2 <- list.files(pattern = pattern2)
print(file_list2)


data_list1 <- lapply(file_list1, function(file) {
  read.table(file, header = TRUE, sep = "")
})
View(data_list1[[1]])

data_list2 <- lapply(file_list2, function(file) {
  read.table(file, header = TRUE, sep = "")
})
View(data_list2[[1]])

#plotting the difference in N200 in the grammatical and nongrammatical conditions
#combining all participant files for each condition
S101_N200 = Reduce(function(...) merge(..., all=T), data_list1)
View(S101_N200)

#participant2 file damaged and missing in S102
S102_N200 = Reduce(function(...) merge(..., all=T), data_list2)
View(S102_N200)

#plotting the two conditions
ggplot((S101_N200), aes (x = File, y = Fp1.Average)) +
 geom_point(color ='blue')

#group columns to form areas of interest
#group participants by language
#2 analyses. a. participant language x N200 activation and b. participant language by areas of interest