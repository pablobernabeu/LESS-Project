---
title: "DGS_24.05"
author: "Gabriella Silva"
editor: "Stella Lucia Pischinger"
date: "2024-05-24"
output: html_document
---

#```{r setup, include=FALSE}
library(dplyr)
library(readr)
library(tidyverse)
library(janitor)
library(readxl)

# Define the path
path_to_DGS <- "Background/Gorilla/Session1"

# Read the files
DGS_1 <- read_csv(file.path(path_to_DGS, "DGS_DGS.csv"))
DGS_2 <- read_csv(file.path(path_to_DGS, "DGS_STROOP.csv"))
DGS_3 <- read_csv(file.path(path_to_DGS, "DGS_ASRT.csv"))

# Upload the additional CSV files
DGS_1_extra <- read_csv(file.path(path_to_DGS, "qdvg4_DGS_DGS.csv"))
DGS_2_extra_1 <- read_csv(file.path(path_to_DGS, "wbij5_DGS_STROOP.csv"))
DGS_2_extra_2 <- read_csv(file.path(path_to_DGS, "xqls8_DGS_STROOP.csv"))

# Combine the data frames
DGS_1 <- bind_rows(DGS_1, DGS_1_extra)
DGS_2 <- bind_rows(DGS_2, DGS_2_extra_1, DGS_2_extra_2)

View(DGS_1)

# Clear column names
colnames(DGS_1) <- make.names(colnames(DGS_1))
colnames(DGS_2) <- make.names(colnames(DGS_2))
colnames(DGS_3) <- make.names(colnames(DGS_3))


# Select columns to combine
DGS_1 <- DGS_1 %>%
  select(Attempt, Correct, display, listLength, Reaction.Time, Participant.Public.ID)

DGS_2 <- DGS_2 %>%
  select(Attempt, Correct, display, listLength, Reaction.Time, Participant.Public.ID)

DGS_3 <- DGS_3 %>%
  select(Attempt, Correct, display, listLength, Reaction.Time, Participant.Public.ID)

# Combine the dataframes
merged_DGS <- bind_rows(DGS_1, DGS_2, DGS_3)


# Group data by Participant.Private.ID
grouped_DGS <- merged_DGS %>%
  group_by(Participant.Public.ID)

# To calculate the average Correct per participant:
avg_correct <- grouped_DGS %>%
  summarize(avg_correct = mean(Correct))

print(avg_correct)

# Calculate the total number of correct digits per participant
total_correct <- merged_DGS %>%
  group_by(Participant.Public.ID) %>%
  summarize(total_correct = sum(Correct))

print(total_correct)

######
#####
# Calculate the number of correct digits for each list length per participant
scores_by_length <- merged_DGS %>%
  group_by(Participant.Public.ID, listLength) %>%
  summarize(total_correct = sum(Correct))

print(scores_by_length)

# Calculate the number of errors per type and per participant
errors <- merged_DGS %>%
  group_by(Participant.Public.ID) %>%
  summarize(omissions = sum(ifelse(Correct == 0 & is.na(display), 1, 0)),
            intrusions = sum(ifelse(Correct == 0 & !is.na(display), 1, 0)),
            repetitions = sum(ifelse(Correct == 0 & display == "Repeat", 1, 0)))

print(errors)

# Combine the results into a single table
analysis_table_DGS <- left_join(total_correct, scores_by_length, by = "Participant.Public.ID") %>%
  left_join(errors, by = "Participant.Public.ID")

print(analysis_table_DGS)

write_csv(analysis_table_DGS, "analysis_table_DGS.csv")
#A greater number of correctly remembered digits indicates a greater 
#working memory capacity.```
#total.correct.x refers to the total number of correct responses per participant
#across lists
#total.correct.y refers to the total number of correct responses per participant
#for each specific list

